gitdtree() {
  local base_dir="$1"

  if [[ ! -d "$base_dir" ]]; then
    echo "Directory not found: $base_dir"
    return 1
  fi

  # Collect all git directories into an array
  local git_dirs=()
  for gitdir in $base_dir/*(/); do
    # Skip worktree directories
    if [[ -d "$gitdir/.git" ]]; then
      git_dirs+=("$gitdir")
    fi
  done

  # Process each directory, using different prefix for last item
  local count=${#git_dirs[@]}
  local index=0
  
  for gitdir in "${git_dirs[@]}"; do
    index=$((index + 1))
    repo_dir="${gitdir%/.git}"
    relative_path="${repo_dir#$base_dir/}"
    changes=$(git -C "$repo_dir" status --short)

    # Use â””â”€â”€ for last item, â”œâ”€â”€ for others
    if [[ $index -eq $count ]]; then
      if [[ -n "$changes" ]]; then
        echo "â””â”€ðŸ”¸$relative_path"
        # Print each line of changes indented with     â””â”€â”€
        echo "$changes" | while read -r line; do
          echo "    â””â”€â”€ $line"
        done
      else
        echo "â””â”€â”€ $relative_path"
      fi
    else
      if [[ -n "$changes" ]]; then
        echo "â”œâ”€ðŸ”¸$relative_path"
        # Print each line of changes indented with â”‚   â””â”€â”€
        echo "$changes" | while read -r line; do
          echo "â”‚   â””â”€â”€ $line"
        done
      else
        echo "â”œâ”€â”€ $relative_path"
      fi
    fi
  done
}